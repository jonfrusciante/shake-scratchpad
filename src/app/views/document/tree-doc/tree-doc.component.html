<div id="tree-wrapper" *ngIf="docData">
  <tree-root #tree [nodes]="nodes" [options]="tree_options"
             (activate)="nodeMoved($event)">

    <ng-template #treeNodeTemplate let-node let-index="index">
      <div (contextmenu)="openTreeMenu($event)" (click)="treeEditorClick($event, node)">
        <div *ngIf="treeNode === node" #itemTreeTrigger="matMenuTrigger" [dir]="isRTL ? 'rtl' : 'ltr'" [matMenuTriggerFor]="treeMenu"></div>
        <div
          class="editor"
          [ngClass]="{
            'set-rtl': isRTL,
            'section-editor-ltr': !isRTL && node.data.nodes,
            'section-editor-rtl': isRTL && node.data.nodes,
            'section-expanded-ltr': !isRTL && !node.isCollapsed,
            'section-expanded-rtl': isRTL && !node.isCollapsed,
            'item-editor-ltr': !isRTL && !node.data.nodes,
            'item-editor-rtl': isRTL && !node.data.nodes
            }"
          [froalaEditor]="editorOptions(node)" [(ngModel)]="node.data.data">
        </div>
      </div>
    </ng-template>
  </tree-root>
</div>


<!-- Menu -->
<mat-menu #treeMenu="matMenu" [overlapTrigger]="'false'" >
  <button *ngIf="treeNode?.children" mat-menu-item (click)="addChildItem(tree.treeModel, treeNode)"><mat-icon>create</mat-icon>Add Item</button>
  <button *ngIf="treeNode?.children" mat-menu-item (click)="addChildItem(tree.treeModel, treeNode , true)"><mat-icon>create_new_folder</mat-icon>Add Section</button>
  <button *ngIf="treeNode?.parent.parent" mat-menu-item (click)="deleteItem(tree.treeModel, treeNode)"><mat-icon>delete</mat-icon>Delete</button>
  <button *ngIf="treeNode?.parent.parent" mat-menu-item [matMenuTriggerFor]="sectionSatMenu"><mat-icon>create_new_folder</mat-icon>Sections</button>
  <button *ngIf="treeNode?.parent.parent" mat-menu-item [matMenuTriggerFor]="itemSatMenu"><mat-icon>create</mat-icon>Items</button>
</mat-menu>

<mat-menu #itemSatMenu="matMenu" >
<button mat-menu-item (click)="addBrotherItem(tree.treeModel, treeNode, false, true)">Add above</button>
<button mat-menu-item (click)="addBrotherItem(tree.treeModel, treeNode, false)">Add below</button>
</mat-menu>


<mat-menu #sectionSatMenu="matMenu" >
<button mat-menu-item (click)="addBrotherItem(tree.treeModel, treeNode, true, true)">Add above</button>
<button mat-menu-item (click)="addBrotherItem(tree.treeModel, treeNode, true)">Add below</button>
</mat-menu>
