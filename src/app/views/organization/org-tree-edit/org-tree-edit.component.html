<tree-root #tree [nodes]="nodes" [options]="tree_options" (moveNode)="moveNode($event)">
  <ng-template #treeNodeTemplate let-node let-index="index">
    <div (click)="treeEditorClick($event, node)">
      <div *ngIf="treeNode === node" #itemTreeTrigger="matMenuTrigger" [dir]="isRTL ? 'rtl' : 'ltr'"
           [matMenuTriggerFor]="treeMenu"></div>
      <span *ngIf="node.data.type"><i class="fa fa-file-text"></i></span>
      <span *ngIf="!node.data.type && node.isExpanded"><i class="fa fa-folder-open-o"></i></span>
      <span *ngIf="!node.data.type && !node.isExpanded"><i class="fa fa-folder-o"></i></span>

      <span *ngIf="node.data.type">{{node.data.name}}</span>
      <span *ngIf="!node.data.type"><input #sectionName type="text"
                                           [value]="node.data.name" placeholder="Add title ..."
                                           (change)="node.data.name = sectionName.value"
                                           (blur)="sectionName.readOnly = true"
                                           (click)="inputClicked($event)" (dblclick)="sectionName.readOnly = false"
                                           readonly>
      </span>
    </div>
  </ng-template>

</tree-root>

<!-- Menu -->
<mat-menu #treeMenu="matMenu" [overlapTrigger]="'false'" >
  <!--<button *ngIf="treeNode?.children" mat-menu-item (click)="addChildItem( treeNode)"><mat-icon>create</mat-icon>Add Item</button>-->
  <button *ngIf="treeNode?.children" mat-menu-item (click)="addChildItem(treeNode , true)"><mat-icon>create_new_folder</mat-icon>Add Section</button>
  <button *ngIf="(treeNode?.parent.parent && treeNode?.children) || (treeNode?.children && treeNode?.parent.children.length > 1)" mat-menu-item (click)="deleteItem(treeNode)"><mat-icon>delete</mat-icon>Delete</button>
  <button *ngIf="treeNode?.children" mat-menu-item [matMenuTriggerFor]="sectionSatMenu"><mat-icon>create_new_folder</mat-icon>Sections</button>
  <!--<button *ngIf="treeNode?.parent.parent" mat-menu-item [matMenuTriggerFor]="itemSatMenu"><mat-icon>create</mat-icon>Items</button>-->
</mat-menu>

<mat-menu #itemSatMenu="matMenu" >
  <button mat-menu-item (click)="addBrotherItem( treeNode, true)">Add above</button>
  <button mat-menu-item (click)="addBrotherItem( treeNode)">Add below</button>
</mat-menu>


<mat-menu #sectionSatMenu="matMenu" >
  <button mat-menu-item (click)="addBrotherItem( treeNode, true)">Add above</button>
  <button mat-menu-item (click)="addBrotherItem( treeNode)">Add below</button>
</mat-menu>
